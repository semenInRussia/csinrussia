---
{"dg-publish":true,"permalink":"/prosto-zadachi/stuck-in-a-rut/"}
---

–≠—Ç–æ #–∑–∞–¥–∞—á–∞ c *Bronze* –¥–∏–≤–∏–∑–∏–æ–Ω–∞ [[–°–∞–π—Ç—ã/usaco.guide\|usaco.guide]] –≤ –≥–ª–∞–≤–µ *Simulation* (—Å–º. [[–ü—Ä–æ—Å—Ç–æ –∑–∞–¥–∞—á–∏/–ó–∞–¥–∞—á–∞ –Ω–∞ –°–∏–º—É–ª—è—Ü–∏—é\|–ó–∞–¥–∞—á–∞ –Ω–∞ –°–∏–º—É–ª—è—Ü–∏—é]]), —Ö–æ—Ç—å —ç—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å —Å–∏–º—É–ª—è—Ü–∏–µ–π (—Å–º. –≥–ª–∞–≤—É –†–µ—à–µ–Ω–∏–µ –°–∏–º—É–ª—è—Ü–∏–µ–π)

*–°—Å—ã–ª–∫–∞*: https://usaco.guide/problems/usaco-1061-stuck-in-a-rut/solution

# –£—Å–ª–æ–≤–∏–µ üìù

> –ù–µ–¥–∞–≤–Ω–æ –§–µ—Ä–º–µ—Ä –î–∂–æ–Ω —É–≤–µ–ª–∏—á–∏–ª —Ä–∞–∑–º–µ—Ä —Å–≤–æ–µ–π —Ñ–µ—Ä–º—ã, —Ç–µ–ø–µ—Ä—å —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –∫–æ—Ä–æ–≤, –æ–Ω–∞ –±–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è –ø–æ —Ä–∞–∑–º–µ—Ä—É. –ö–æ—Ä–æ–≤—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –ø–∞—Å—Ç–±–∏—â–µ —Ñ–µ—Ä–º—ã –∫–∞–∫ –±–µ—Å–∫–æ–Ω–µ—á–Ω—É—é 2D —Ä–µ—à—ë—Ç–∫—É –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö —è—á–µ–µ–∫, –∫–∞–∂–¥–∞—è –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ –≤–∫—É—Å–Ω–µ–π—à–µ–π —Ç—Ä–∞–≤–æ–π. (–î—É–º–∞–π—Ç–µ –æ –∫–∞–∂–¥–æ–π —è—á–µ–π–∫–µ –∫–∞–∫ –æ –∫–ª–µ—Ç–∫–µ –Ω–∞ —à–∞—Ö–º–∞—Ç–Ω–æ–π –¥–æ—Å–∫–µ). –ö–∞–∂–¥–∞—è –∏–∑ $N$ –∫–æ—Ä–æ–≤ ($1 \leq N \leq 100$) –§–î –Ω–∞—á–∏–Ω–∞–µ—Ç –≤ —Ä–∞–∑–ª–∏—á–Ω–æ–π —è—á–µ–π–∫–µ. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—á–∏–Ω–∞—é—Ç, –≥–ª—è–¥—è –Ω–∞ —Å–µ–≤–µ—Ä, –∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ - –Ω–∞ –≤–æ—Å—Ç–æ–∫.  –ö–∞–∂–¥—ã–π —á–∞—Å –∫–æ—Ä–æ–≤–∞ –∏–ª–∏ –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏ —Ç—Ä–∞–≤–∞ –≤ —Ç–µ–∫—É—â–µ–π —è—á–µ–π–∫–µ —É–∂–µ —Å—ä–µ–¥–µ–Ω–∞ –¥—Ä—É–≥–æ–π –∫–æ—Ä–æ–≤–æ–π.  –°—ä–µ–¥–∞–µ—Ç –≤—Å—é —Ç—Ä–∞–≤—É –≤ —Ç–µ–∫—É—â–µ–π —è—á–µ–π–∫–µ –∏ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –Ω–∞ –æ–¥–Ω—É —è—á–µ–π–∫—É –≤–ø–µ—Ä—ë–¥ –≤ —Å–≤–æ—ë–º –∏—Å—Ö–æ–¥–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏.
>
> –ß–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è –∫–∞–∂–¥–∞—è –∫–æ—Ä–æ–≤–∞ –æ—Å—Ç–∞–≤–∏—Ç –∑–∞ —Å–æ–±–æ–π –∫–æ–ª–µ—é –ø—É—Å—Ç—ã—Ö —è—á–µ–µ–∫.
>
> –ï—Å–ª–∏ –¥–≤–µ –∫–æ—Ä–æ–≤—ã –ø–æ–ø–∞–¥—É—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–∞ –æ–¥–Ω—É –∏ —Ç—É –∂–µ —è—á–µ–π–∫—É —Å —Ç—Ä–∞–≤–æ–π, –æ–Ω–∏ –ø–æ–µ–¥—è—Ç –≤–º–µ—Å—Ç–µ –∏ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç –¥–≤–∏–∂–µ–Ω–∏–µ –≤ —Å–≤–æ–∏—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö –≤ —Å–ª–µ–¥—É—é—â–∏–π —á–∞—Å.
>
> –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–∞–≤—ã, —Å—ä–µ–¥–µ–Ω–Ω–æ–π –∫–∞–∂–¥–æ–π –∫–æ—Ä–æ–≤–æ–π. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–æ—Ä–æ–≤—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –æ—Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –∏ –ø–æ—ç—Ç–æ–º—É —Å—ä–µ–¥—è—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–∞–≤—ã.
>
> ### –§–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞ (—Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã / stdin):
>
> –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –≤–≤–æ–¥–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç $N$. –ö–∞–∂–¥–∞—è –∏–∑ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö $N$ —Å—Ç—Ä–æ–∫ –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å—Ç–∞—Ä—Ç–æ–≤—É—é –ø–æ–∑–∏—Ü–∏—é –∫–æ—Ä–æ–≤—ã –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö —Å–∏–º–≤–æ–ª ($N$ - –µ—Å–ª–∏ –±—É–¥–µ—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è –Ω–∞ —Å–µ–≤–µ—Ä, E –µ—Å–ª–∏ –±—É–¥–µ—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è –Ω–∞ –≤–æ—Å—Ç–æ–∫) –∏ –¥–≤–∞ –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—ã—Ö —á–∏—Å–ª–∞ x –∏ y ($0 \leq x \leq 10^9$; $0 \leq y \leq 10^9$) –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —è—á–µ–π–∫–∏. $x$ -**–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ä–∞–∑–ª–∏—á–Ω—ã –¥–ª—è –≤—Å–µ—Ö** –∫–æ—Ä–æ–≤, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∏ $y$ -**–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ä–∞–∑–ª–∏—á–Ω—ã –¥–ª—è –≤—Å–µ—Ö –∫–æ—Ä–æ–≤**.  –ß—Ç–æ–±—ã –±—ã–ª–æ –ø–æ–Ω—è—Ç–Ω–µ–µ, –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç, –µ—Å–ª–∏ –∫–æ—Ä–æ–≤–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —è—á–µ–π–∫–µ $(x, y)$ –∏ –¥–≤–∏–≥–∞–µ—Ç—Å—è –Ω–∞ —Å–µ–≤–µ—Ä, —Ç–æ –æ–Ω–∞ –ø–µ—Ä–µ–π–¥—ë—Ç –≤ —è—á–µ–π–∫—É $(x, y+1)$ , –∞ –µ—Å–ª–∏ –Ω–∞ –≤–æ—Å—Ç–æ–∫ - —Ç–æ –≤ —è—á–µ–π–∫—É $(x+1, y)$.
>
> ### –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ (–Ω–∞ —ç–∫—Ä–∞–Ω / stdout):
> –í—ã–≤–µ–¥–∏—Ç–µ $N$ —Å—Ç—Ä–æ–∫. –°—Ç—Ä–æ–∫–∞ $i$ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —è—á–µ–µ–∫ —Ç—Ä–∞–≤—ã, –∫–æ—Ç–æ—Ä–∞—è —Å—ä–µ—Å—Ç $i$-–∞—è –∫–æ—Ä–æ–≤–∞. –ï—Å–ª–∏ –∫–æ—Ä–æ–≤–∞ —Å—ä–µ—Å—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–∞–≤—ã, –≤—ã–≤–µ–¥–∏—Ç–µ "Infinity" –¥–ª—è —ç—Ç–æ–π –∫–æ—Ä–æ–≤—ã.
>

# –û–ø–∏—Å–∞–Ω–∏–µ

–ù–∞–¥–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ–≥–¥–∞ –∫–æ—Ä–æ–≤–∞ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Å—ä–µ–¥–µ–Ω–Ω–æ–π –∫–ª–µ—Ç–∫–µ –∏ –¥–æ–ª–∂–Ω–∞ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è.  –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–≥–¥–∞ –∫–æ–≥–¥–∞ –¥–≤–µ –∫–æ—Ä–æ–≤—ã, –æ–¥–Ω–æ, —Ö–æ–¥—è—â–∞—è –Ω–∞ —Å–µ–≤–µ—Ä, –¥—Ä—É–≥–∞—è, —Ö–æ–¥—è—â–∞—è –Ω–∞ –≤–æ—Å—Ç–æ–∫, –∫–æ—Ä–æ–≤—ã –ø–æ–ø–∞–¥–∞—é—Ç—Å—è –Ω–∞ –ø—É—Ç–∏.  –¢. –µ. –º–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –∫–æ—Ä–æ–≤—ã –Ω–∞ *E-–∫–æ—Ä–æ–≤—ã* (–Ω–∞ –í–æ—Å—Ç–æ–∫) –∏ *W-–∫–æ—Ä–æ–≤—ã* (–Ω–∞ –°–µ–≤–µ—Ä), –∏ —Å–º–æ—Ç—Ä–µ—Ç—å —á–µ—Ä–µ–∑ –∫–∞–∫–æ–µ –≤—Ä–µ–º—è –æ–Ω–∏ –º–æ–≥—É—Ç –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å—Å—è.  –î–ª—è –∫–∞–∂–¥–æ–π *E-–∫–æ—Ä–æ–≤—ã* –±—É–¥–µ–º –∏—Å–∫–∞—Ç—å *W-–∫–æ—Ä–æ–≤—É* –∏ –µ—Å–ª–∏ *E-–∫–æ—Ä–æ–≤–∞* –±—ã—Å—Ç—Ä–µ–µ –¥–æ—Ö–æ–¥–∏—Ç –¥–æ –¥—Ä—É–≥–æ–π, —Ç–æ –∑–¥–µ—Å—å –æ–Ω–∞ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è.  –û–±—â–µ –∏–∑–∏.  –ß—Ç–æ–±—ã –æ—Ç–≤–µ—Ç –±—ã–ª –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –Ω–∞–¥–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ—Ä–æ–≤ –ø–æ –∏—Ö `x` –∏ `y`

# –ò—Ö –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ üßë‚Äçüíª

```cpp
#include <bits/stdc++.h>
using namespace std;

struct Cow {
  int x, y;
  int ind;
};

int main() {
  int n;
  cin >> n;
  vector<Cow> n_cows;
  vector<Cow> e_cows;

  for (int i = 0; i < n; i++) {
    char dir;
    int x, y;
    cin >> dir >> x >> y;
    if (dir == 'N') {
      n_cows.push_back({x, y, i});
    } else if (dir == 'E') {
      e_cows.push_back({x, y, i});
    }
  }

  sort(n_cows.begin(), n_cows.end(),
       [&](const Cow &c1, const Cow &c2) { return c1.x < c2.x; });
  sort(e_cows.begin(), e_cows.end(),
       [&](const Cow &c1, const Cow &c2) { return c1.y < c2.y; });

  vector<int> stop_pos(n, -1);
  for (const Cow &ncow : n_cows) {
    for (const Cow &ecow : e_cows) {
      // Check that the two cows will intersect.
      if (ncow.x > ecow.x && ncow.y < ecow.y) {
        // Distance they travel before reaching the other cow's line.
        int n_trav = ecow.y - ncow.y;
        int e_trav = ncow.x - ecow.x;

        // Check if the north cow blocks the east cow.
        if (n_trav < e_trav && stop_pos[ecow.ind] == -1) {
          // # Save the x-coordinate at which the east cow stops
          stop_pos[ecow.ind] = ncow.x;
        }

        // Check if the east cow blocks the north cow.
        if (n_trav > e_trav && stop_pos[ecow.ind] == -1) {
          // Save the y-coordinate at which the north cow stops
          stop_pos[ncow.ind] = ecow.y;
          // At this point we can move on- this cow won't move
          // anymore.
          break;
        }
      }
    }
  }

  vector<int> dist(n, -1);
  for (const Cow &nc : n_cows) {
    // A cow eats a finite amount of grass if & only if this value isn't -1.
    if (stop_pos[nc.ind] != -1) {
      // Eaten is (stopped position - original position)
      dist[nc.ind] = stop_pos[nc.ind] - nc.y;
    }
  }

  for (const Cow &ec : e_cows) {
    if (stop_pos[ec.ind] != -1) {
      dist[ec.ind] = stop_pos[ec.ind] - ec.x;
    }
  }

  for (int d : dist) {
    cout << (d == -1 ? "Infinity" : to_string(d)) << '\n';
  }
}
```


# –†–µ—à–µ–Ω–∏–µ –°–∏–º—É–ª—è—Ü–∏–µ–π

–Ø –ø—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞–º —Å–≤–æ—ë –ø–æ–ª–µ –∫–æ—Ä–æ–≤, –∫–∞–∂–¥–∞—è –∏–∑ –∫–æ—Ä–æ–≤ –±—É–¥–µ—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è –≤ –Ω—É–∂–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏, —Å—Ç–∞–ª–∫–∏–≤–∞—Ç—å—Å—è, –∞ —è –±—É–¥—É –Ω–∞–¥ —ç—Ç–∏–º —Å–º–æ—Ç—Ä–µ—Ç—å.  –†–µ—à–µ–Ω–∏–µ –¥—É–º–∞—é –æ–±—Ö—è—Å–Ω—è—Ç—å –Ω–µ —Å—Ç–æ–∏—Ç.  –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —è —Ö—Ä–∞–Ω–∏–ª "—Å—ä–µ–¥–µ–Ω–Ω—ã–µ –∫–ª–µ—Ç–∫–∏" –≤ `map` ([[–°—Ç—Ä—É–∫—Ç—É—Ä—ã –î–∞–Ω–Ω—ã—Ö/–ö—Ä–∞—Å–Ω—ã–µ, –ß—ë—Ä–Ω—ã–µ –î–µ—Ä–µ–≤—å—è\|–ö—Ä–∞—Å–Ω—ã–µ, –ß—ë—Ä–Ω—ã–µ –î–µ—Ä–µ–≤—å—è]]), —á—Ç–æ–±—ã –∑–∞ `O(log N)` —Å–º–æ—Ç—Ä–µ—Ç—å —Å—ä–µ–¥–µ–Ω–∞ –ª–∏ –∫–ª–µ—Ç–∫–∞.  –ë—É–¥—É –∏–≥—Ä–∞—Ç—å 100'000 —Ä–∞—É–Ω–¥–æ–≤, —á—Ç–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, –Ω–æ –Ω–∞ –±–æ–ª—å—à–µ–µ –Ω–µ —Ö–≤–∞—Ç–∏—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –≤—Ä–µ–º–µ–Ω–∏

–ò –¥–∞ —ç—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ 100%

```cpp
#include <iostream>
#include <set>
#include <vector>

using namespace std;

struct Cow {
  int id, x, y;
  char dir;
};

int main() {
  int n;
  cin >> n;
  vector<Cow> cows(n);
  int t = 0;
  for (auto &cow : cows) {
    cin >> cow.dir >> cow.x >> cow.y;
    cow.id = t++;
  }

  using point = pair<int, int>;

  set<point> f;
  vector<int> eaten(n);

  const int maxround = 100'000;

  for (int round = 0; round < maxround; round++) {
    vector<point> toadd;
    for (auto &cow : cows) {
      if (cow.id == -1)
        continue;

      point p = {cow.x, cow.y};
      if (f.count(p)) {
        // a cell is busy
        cow.id = -1;
        continue;
      }

      eaten[cow.id]++;
      toadd.push_back(p);
      if (cow.dir == 'N')
        cow.y++;
      else
        cow.x++;
    }

    for (auto p : toadd)
      f.insert(p);
  }

  for (auto cow : cows)
    if (cow.id != -1)
      eaten[cow.id] = -1;

  for (int i = 0; i < n; i++) {
    cout << (eaten[i] == -1 ? "Infinity" : tostring(eaten[i])) << '\n';
  }
}

```