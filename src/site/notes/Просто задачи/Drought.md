---
{"dg-publish":true,"permalink":"/prosto-zadachi/drought/"}
---

#–∑–∞–¥–∞—á–∞ 

–£ –¥–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏ –Ω–∞ [[–°–∞–π—Ç—ã/usaco.guide\|usaco.guide]] —Å—Ç–æ–∏—Ç —É—Ä–æ–≤–µ–Ω—å *Normal*, —Å —á–µ–º —è –Ω–µ —Å–æ–≥–ª–∞—Å–µ–Ω.  –ü–æ-–º–æ–µ–º—É —ç—Ç–æ –∫—Ä–µ–ø–∫–∏–π *Hard*.  –•–æ—Ç—å —Ä–µ—à–µ–Ω–∏–µ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ, –¥–æ –Ω–µ–≥–æ –æ–¥—É–º–∞—Ç—å—Å—è –æ—á–µ–Ω—å –Ω–µ *–ø—Ä–æ—Å—Ç–æ* **–∏–º—Ö–æ**.  –ú–Ω–æ–≥–∏–µ *Very Hard* –¥–∞–∂–µ –ø–æ–ª–µ–≥—á–µ.  –î–∏–≤–∏–∑–∏–æ–Ω –±—Ä–æ–Ω–∑–∞.  –£–¥–∞—á–∏!

# –£—Å–ª–æ–≤–∏–µ üìì
–ü–æ–ª–Ω–æ–µ
http://usaco.org/index.php?page=viewproblem2&cpid=1181

> –ï—Å—Ç—å $N$ –∫–æ—Ä–æ–≤, –∫–∞–∂–¥–∞—è —Ö–æ—á–µ—Ç –µ—Å—Ç—å, –∏ —É –ª—é–±–æ–π –∫–æ—Ä–æ–≤—ã $i$ –µ—Å—Ç—å —É—Ä–æ–≤–µ–Ω—å –≥–æ–ª–æ–¥–∞ $h_i$.
> 
> –ö–æ—Ä–º—£–∂–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ —Å–ª–µ–¥—É—é—â–µ–º—É –∞–ª–≥–æ—Ä–∏—Ç–º—É: –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –¥–≤–µ **—Å–æ—Å–µ–¥–Ω–∏–µ** –∫–æ—Ä–æ–≤—ã; –ò–º –æ–±–æ–∏–º –¥–∞—ë—Ç—Å—è –ø–æ –æ–¥–Ω–æ–π –ø–æ—Ä—Ü–∏–∏; –∏—Ö —É—Ä–æ–≤–µ–Ω—å –≥–æ–ª–æ–¥–∞ –ø–∞–¥–∞–µ—Ç –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É.  –ó–∞–¥–∞—á–∞ –Ω–∞–π—Ç–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ—Ä–º—É, –Ω—É–∂–Ω–æ–µ —á—Ç–æ–±—ã —É –≤—Å–µ—Ö –∫–æ—Ä–æ–≤ –±—ã–ª –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å –∫–æ—Ä–º–∞.

# –†–∞–∑–º—ã—à–ª–µ–Ω–∏–µ

–ë–ª—è –Ω–∞—á–∞–ª–∞ –∑–∞–≤–µ–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é $t$, –æ–±–æ–∑–Ω–∞—á–∞—é—â—É—é —É—Ä–æ–≤–µ–Ω—å –∫–æ—Ä–º, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —É –∫–∞–∂–¥–æ–π –∫–æ—Ä–æ–≤—ã –∫ –∫–æ–Ω—Ü—É –∫–æ—Ä–º—ë–∂–∫–∏.

–ù–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ –≤–∞–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –µ—Å–ª–∏ $h_2 > h_1$ (–Ω—É–º–µ—Ä–∞—Ü–∏—è —Å 1) –∏ –ø—Ä–∏ —ç—Ç–æ–º $h_2 \leq t$, —Ç–æ $t$ ‚Äî –Ω–µ–≤–µ—Ä–Ω–æ–µ.  –¢–æ–∂–µ —Å–∞–º–æ–µ —Å $h_n > h_{n-1}$.

–ï—â—ë –æ—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ $t$ –±—É–¥–µ—Ç –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º—É $h_i$, –≤–µ–¥—å –∏—Ö –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ —É–º–µ–Ω—å—à–∞—Ç—å.

–û—á–µ–≤–∏–¥–Ω–∞—è (–∏–ª–∏ –Ω–µ –æ—á–µ–≤–∏–¥–Ω–∞—è) –∏–¥–µ—è —ç—Ç–æ —ç—Ç–æ —Ö–æ–¥–∏—Ç—å —Å–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ –∏ –¥–∞–≤–∞—Ç—å –æ–¥–Ω–æ–π –∫–æ—Ä–æ–≤–µ –∞–±—Å–æ–ª—é—å–Ω—É—é —Ä–∞–∑–Ω–∏—Ü—É —É—Ä–æ–≤–Ω–µ–π –≥–æ–ª–æ–¥–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è –≤ –Ω–∞—á–∞–ª–æ —Å–ø–∏—Å–∫–∞, –ø–æ—Ç–æ–º —ç—Ç–æ –ø–æ–≤—Ç–æ—Ä—è—Ç—å —ç—Ç–æ –ø–æ–∫–∞ –≤—Å–µ –Ω–µ –±—É–¥—É—Ç –∏–º–µ—Ç—å –æ–¥–∏–Ω —É—Ä–æ–≤–µ–Ω—å.  –í–∞–∂–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤—ã—à–µ—É–ø–æ–º—è–Ω—É—Ç—ã–µ —á–∞—Å—Ç–Ω—ã–µ —Å–ª—É—á–∞–∏, –æ–±–æ–∑–Ω–∞—á–∞—é—â–∏–µ —á—Ç–æ —Ä–µ—à–µ–Ω–∏—è –Ω–µ—Ç.

–î–∞–ª—å—à–µ –æ–Ω–∏ –ø—Ä–µ–¥–ª–∞–≥–∞—é –¥–µ–ª–∞—Ç—å –≤–æ—Ç, —á—Ç–æ.

–ö–∞–∂–¥—ã–º –¥–≤—É–º —Å–æ—Å–µ–¥–Ω–∏–º –∫–æ—Ä–æ–≤–∞–º, —É—Ä–æ–≤–µ–Ω—å –ª–µ–≤–æ–π –∫–æ—Ä–æ–≤—ã —É –∫–æ—Ç–æ—Ä–æ–π –º–µ–Ω—å—à–µ.  –î–∞–≤–∞—Ç—å —Å—Ç–æ–ª—å–∫–æ –∫–æ—Ä–º–∞, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –ª–µ–≤—É—é —Ç–∞–∫–æ–π –º–∞–ª–µ–Ω—å–∫–æ–π –∫–∞–∫ –ø—Ä–∞–≤—É—é (–¥–∞—Ç—å —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É —É—Ä–æ–≤–Ω—è–º–∏ –∫–æ—Ä–º–∞).  –ü–æ—Ç–æ–º –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—å —Å–ø–∏—Å–æ–∫ –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å.  –ù–µ –∑–∞–±—ã–≤–∞—Ç—å –ø—Ä–æ –±–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π.

# –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ üåé

```cpp
#include<bits/stdc++.h>
#define int long long
#define nl "\n"
using namespace std;

int exe(){
	int ans = 0, n;
	cin >> n; vector<int> h(n);
	for (int& i : h) cin >> i;
	if (n == 1) return 0;
	for (int j : {1, 2}){
		for (int i = 1; i < n - 1; i++){
			if (h[i] > h[i - 1]){
				int dif = h[i] - h[i - 1];
				ans += 2 * dif, h[i + 1] -= dif, h[i] = h[i - 1];
			}
		}
		if (h[n - 1] > h[n - 2]) return -1;
		// now h is non-increasing
		reverse(h.begin(), h.end());
		// now h is non-decreasing
	}
	// now h is all equal
	return h[0] < 0 ? -1 : ans;
}

signed main(){
	cin.tie(0)->sync_with_stdio(0); cin.exceptions(ios_base::failbit);
	int t; cin >> t;
	while (t--) cout << exe() << nl;
}
```